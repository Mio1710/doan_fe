import{d as g,Z as W,a as b,S as F,t as $,L as T,A as e,z as t,M as c,r as M,O as U,i as z,V as k,P as _,B as v,x as V,y as q,Q as x,T as H,v as N,R as O}from"./C5o3XgM8.js";import{_ as P}from"./BQ-m9GLv.js";import{_ as C}from"./GQ_XKnWl.js";import{P as B,_ as A}from"./DZ_F3gcz.js";import{V as S}from"./BGMHy2BI.js";import{V as Q}from"./BucRdiyx.js";import{V as D}from"./DSXWEGHE.js";import"./Qrp8M8cl.js";import"./DKVj5txg.js";import"./Cuta4Q8k.js";import"./CkMhjDa3.js";import"./C9IY8SFK.js";import"./ClqTeD8V.js";const j=g({__name:"CreateFaculty",emits:["cancel"],setup(s,{emit:m}){const d=W({ten:"",ma_khoa:""}),{$api:a,$toast:h}=b(),p=m,r=F(),f=()=>{a.faculty.createFaculty(d).then(()=>{h.success("Tạo khoa thành công"),r.invalidateQueries("faculty"),p("cancel")})};return(y,o)=>($(),T(P,{"can-cancel":"","cancel-text":"Hủy",title:"Tạo khoa",onCancel:o[2]||(o[2]=n=>p("cancel")),onSubmit:f},{default:e(()=>[t(C,{modelValue:c(d).ten,"onUpdate:modelValue":o[0]||(o[0]=n=>c(d).ten=n),name:"Tên khoa",label:"Tên khoa",rules:"required"},null,8,["modelValue"]),t(C,{modelValue:c(d).ma_khoa,"onUpdate:modelValue":o[1]||(o[1]=n=>c(d).ma_khoa=n),name:"Mã khoa",label:"Mã khoa"},null,8,["modelValue"])]),_:1}))}}),E=g({__name:"UpdateFaculty",props:{topic:{type:Object,required:!0}},emits:["cancel"],setup(s,{emit:m}){const a=M({...s.topic}),{$api:h,$toast:p}=b(),r=m,f=F(),y=()=>{h.faculty.updateFaculty(a.value.id,a.value).then(()=>{p.success("Cập nhật khoa thành công"),f.invalidateQueries("faculty"),r("cancel")})};return(o,n)=>($(),T(P,{"can-cancel":"","cancel-text":"Hủy",title:"Tạo đề tài",onCancel:n[2]||(n[2]=l=>r("cancel")),onSubmit:y},{default:e(()=>[t(C,{modelValue:c(a).ten,"onUpdate:modelValue":n[0]||(n[0]=l=>c(a).ten=l),label:"Tên khoa",name:"Tên khoa",rules:"required"},null,8,["modelValue"]),t(C,{modelValue:c(a).ma_khoa,"onUpdate:modelValue":n[1]||(n[1]=l=>c(a).ma_khoa=l),label:"Mã khoa",name:"Mã khoa"},null,8,["modelValue"])]),_:1}))}});function R(s,m){return s?Array.isArray(s)?A.map(A.zip(s,m),([d,a])=>a==="desc"?`-${d}`:d):[m==="desc"?`-${s}`:s]:[]}function X(s,m){const{$api:d}=b(),a=U(["faculty-admins",s],()=>{const{sortBy:r,sortType:f}=s.value,y=R(r,f),o=new B({includes:[],appends:[],fields:{},filters:{},sorts:y,page:s.value.page,limit:s.value.rowsPerPage,payload:null,...s.value}).query();return d.superAdmin.getFacultyWithAdmin(o)},{refetchOnWindowFocus:!1,...m}),h=z(()=>{var r;return((r=a.data.value)==null?void 0:r.data)||[]}),p=z(()=>{var r,f;return((f=(r=a.data.value)==null?void 0:r.pagination)==null?void 0:f.total)||0});return{...a,items:h,totalItems:p}}const I=g({__name:"CreateSuperTeacher",props:{faculty:{type:Object,required:!0}},emits:["cancel","success"],setup(s,{emit:m}){const a=W({hodem:"",ten:"",maso:"",email:"",khoa_id:s.faculty.id,type:"teacher"}),{$api:h,$toast:p}=b(),r=m,f=()=>{h.admin.createSuperTeacher(a).then(()=>{p.success("Tạo cán bộ khoa thành công"),r("success"),r("cancel")})};return(y,o)=>($(),T(P,{"can-cancel":"","cancel-text":"Hủy",title:`Tạo cán bộ ${s.faculty.ten}`,onCancel:o[4]||(o[4]=n=>r("cancel")),onSubmit:f},{default:e(()=>[t(C,{modelValue:c(a).hodem,"onUpdate:modelValue":o[0]||(o[0]=n=>c(a).hodem=n),label:"Họ đệm",name:"Họ đệm",rules:"required"},null,8,["modelValue"]),t(C,{modelValue:c(a).ten,"onUpdate:modelValue":o[1]||(o[1]=n=>c(a).ten=n),label:"Tên",name:"Tên",rules:"required"},null,8,["modelValue"]),t(C,{modelValue:c(a).email,"onUpdate:modelValue":o[2]||(o[2]=n=>c(a).email=n),label:"Email",name:"Email",rules:"required|email"},null,8,["modelValue"]),t(C,{modelValue:c(a).maso,"onUpdate:modelValue":o[3]||(o[3]=n=>c(a).maso=n),label:"Mã số",name:"Mã số",rules:"required"},null,8,["modelValue"])]),_:1},8,["title"]))}}),L=g({__name:"ListSuperTeacher",props:{faculty:{type:Object,required:!0}},emits:["cancel"],setup(s,{emit:m}){W({hodem:"",ten:"",maso:"",email:"",khoa_id:s.faculty.id,type:"teacher"});const{$api:a,$toast:h}=b(),p=m,r=F(),f=[{title:"STT",align:"center",sortable:!1,key:"index",width:30},{title:"Tên giảng viên",key:"ten",minWidth:150},{title:"Mã số",key:"maso",width:"10%",minWidth:100},{title:"Hành động",key:"action",width:"30%",minWidth:350,align:"center"}],y=l=>{a.superAdmin.deleteSuperTeacher(l.id).then(()=>{h.success("Xóa cán bộ khoa thành công"),r.invalidateQueries("faculty-admins"),p("cancel")})},o=()=>{r.invalidateQueries("faculty-admins"),p("cancel")},n=l=>{a.admin.resetPassword(l.id).then(()=>{h.success("Reset mật khẩu thành công")})};return(l,i)=>($(),T(P,{"can-cancel":"","cancel-text":"Đóng","hide-submit":"",title:`Danh sách cán bộ ${s.faculty.ten}`,onCancel:i[0]||(i[0]=u=>p("cancel"))},{default:e(()=>[t(S,{"min-width":"400",width:"40%"},{activator:e(({props:u})=>[t(k,_(u,{class:"mb-4",color:"success",size:"small"}),{default:e(()=>i[1]||(i[1]=[v("Tạo cán bộ khoa")])),_:2},1040)]),default:e(({isActive:u})=>[t(I,{faculty:s.faculty,onCancel:w=>u.value=!1,onSuccess:o},null,8,["faculty","onCancel"])]),_:1}),s.faculty?($(),T(Q,{key:0,headers:f,"hide-default-footer":"",items:s.faculty.teachers},{"item.index":e(({index:u})=>[V("span",null,q(u+1),1)]),"item.ten":e(({item:u})=>[V("span",null,q(u.hodem)+" "+q(u.ten),1)]),"item.action":e(({item:u})=>[t(k,{color:"primary",size:"small",class:"mr-2",onClick:w=>n(u)},{default:e(()=>[t(x,null,{default:e(()=>i[2]||(i[2]=[v("mdi-refresh")])),_:1}),i[3]||(i[3]=V("span",null,"Reset mật khẩu",-1))]),_:2},1032,["onClick"]),t(k,{color:"error",size:"small",onClick:w=>y(u)},{default:e(()=>i[4]||(i[4]=[v("Xóa")])),_:2},1032,["onClick"])]),_:1},8,["items"])):H("",!0)]),_:1},8,["title"]))}}),G={class:"d-flex flex-column flex-grow-1 h-full"},K={class:"d-flex items-center"},Z={class:"mt-2"},de=g({__name:"faculty",setup(s){const m=[{title:"STT",align:"start",sortable:!1,key:"index",width:30},{title:"Tên khoa",key:"ten",minWidth:250},{title:"Mã khoa",key:"ma_khoa",width:"30%",minWidth:350},{title:"Cán bộ khoa",key:"super_teachers",width:"30%",minWidth:300,align:"center"},{title:"",key:"action",width:"10%",minWidth:100,sortable:!1,align:"center"}],d=M({page:1,rowsPerPage:25,sortBy:"-created_at",sortType:"asc"}),a=z(()=>({...d.value})),{$api:h,$toast:p}=b(),r=F(),f=n=>{h.faculty.deleteFaculty(n.id).then(()=>{p.success("Xóa khoa thành công"),r.invalidateQueries("faculty-admins")})},{items:y,refetch:o}=X(a);return(n,l)=>($(),N("div",G,[l[7]||(l[7]=V("div",{class:"text-lg font-bold text-uppercase"},"Quản lý khoa",-1)),t(D,{class:"pa-3 h-full",color:"white",variant:"flat"},{default:e(()=>[V("div",K,[t(S,{"min-width":"400",width:"40%"},{activator:e(({props:i})=>[t(k,_({color:"success",size:"small"},i),{default:e(()=>[t(x,null,{default:e(()=>l[1]||(l[1]=[v("mdi-plus")])),_:1}),l[2]||(l[2]=V("span",null,"Thêm mới Khoa",-1))]),_:2},1040)]),default:e(({isActive:i})=>[t(j,{onCancel:u=>i.value=!1},null,8,["onCancel"])]),_:1}),t(O),t(k,{icon:"",size:"x-small",variant:"text",onClick:l[0]||(l[0]=i=>c(o)())},{default:e(()=>[t(x,null,{default:e(()=>l[3]||(l[3]=[v("mdi-refresh")])),_:1})]),_:1})]),V("div",Z,[t(Q,{headers:m,"hide-default-footer":"",items:c(y)},{"item.index":e(({index:i})=>[V("span",null,q(i+1),1)]),"item.super_teachers":e(({item:i})=>[t(S,{"min-width":"600",width:"60%"},{activator:e(({props:u})=>[t(k,_(u,{color:"success",size:"small"}),{default:e(()=>l[4]||(l[4]=[v("Cán bộ khoa")])),_:2},1040)]),default:e(({isActive:u})=>[t(L,{faculty:i,onCancel:w=>u.value=!1},null,8,["faculty","onCancel"])]),_:2},1024)]),"item.action":e(({item:i})=>[t(S,{"min-width":"400",width:"40%"},{activator:e(({props:u})=>[t(k,_(u,{color:"success",icon:"",size:"small",variant:"text"}),{default:e(()=>[t(x,null,{default:e(()=>l[5]||(l[5]=[v("mdi-pencil")])),_:1})]),_:2},1040)]),default:e(({isActive:u})=>[t(E,{topic:i,onCancel:w=>u.value=!1},null,8,["topic","onCancel"])]),_:2},1024),t(k,{color:"error",icon:"",size:"small",variant:"text",onClick:u=>f(i)},{default:e(()=>[t(x,null,{default:e(()=>l[6]||(l[6]=[v("mdi-trash-can")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])])]),_:1})]))}});export{de as default};
