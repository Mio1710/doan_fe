import{d as T,$ as z,a as C,P as F,t as $,L as w,A as t,z as a,M as u,r as A,O as Q,i as P,R as g,Q as _,B as h,x as y,y as x,V as b,T as N,v as H,S as O}from"./sjUhAvvQ.js";import{_ as S}from"./BchFbIxZ.js";import{_ as V}from"./ToVgvsDd.js";import{P as D,_ as W}from"./DZ_F3gcz.js";import{V as q}from"./DMZBU9fF.js";import{V as M}from"./Cx9EZ3Dw.js";import{V as X}from"./Do9P-qNa.js";import"./D6BUiA2n.js";import"./C5tCWyF6.js";import"./BHFGkcei.js";import"./BRtmg2Ro.js";import"./Cw6M3Hk1.js";import"./tlA2e_jv.js";const j=T({__name:"CreateFaculty",emits:["cancel"],setup(o,{emit:m}){const c=z({ten:"",ma_khoa:""}),{$api:l,$toast:f}=C(),d=m,i=F(),s=()=>{l.faculty.createFaculty(c).then(()=>{f.success("Tạo khoa thành công"),i.invalidateQueries("faculty-admins"),d("cancel")})};return(r,e)=>($(),w(S,{"can-cancel":"","cancel-text":"Hủy",title:"Tạo khoa",onCancel:e[2]||(e[2]=n=>d("cancel")),onSubmit:s},{default:t(()=>[a(V,{modelValue:u(c).ten,"onUpdate:modelValue":e[0]||(e[0]=n=>u(c).ten=n),label:"Tên khoa",name:"Tên khoa",rules:"required"},null,8,["modelValue"]),a(V,{modelValue:u(c).ma_khoa,"onUpdate:modelValue":e[1]||(e[1]=n=>u(c).ma_khoa=n),label:"Mã khoa",name:"Mã khoa",rules:"required"},null,8,["modelValue"])]),_:1}))}}),B=T({__name:"UpdateFaculty",props:{topic:{type:Object,required:!0}},emits:["cancel"],setup(o,{emit:m}){const l=A({...o.topic}),{$api:f,$toast:d}=C(),i=m,s=F(),r=()=>{f.faculty.updateFaculty(l.value.id,l.value).then(()=>{d.success("Cập nhật khoa thành công"),s.invalidateQueries("faculty-admins"),i("cancel")})};return(e,n)=>($(),w(S,{"can-cancel":"","cancel-text":"Hủy",title:"Tạo đề tài",onCancel:n[2]||(n[2]=k=>i("cancel")),onSubmit:r},{default:t(()=>[a(V,{modelValue:u(l).ten,"onUpdate:modelValue":n[0]||(n[0]=k=>u(l).ten=k),label:"Tên khoa",name:"Tên khoa",rules:"required"},null,8,["modelValue"]),a(V,{modelValue:u(l).ma_khoa,"onUpdate:modelValue":n[1]||(n[1]=k=>u(l).ma_khoa=k),label:"Mã khoa",name:"Mã khoa",rules:"required"},null,8,["modelValue"])]),_:1}))}});function E(o,m){return o?Array.isArray(o)?W.map(W.zip(o,m),([c,l])=>l==="desc"?`-${c}`:c):[m==="desc"?`-${o}`:o]:[]}function R(o,m){const{$api:c}=C(),l=Q(["faculty-admins",o],()=>{const{sortBy:i,sortType:s}=o.value,r=E(i,s),e=new D({includes:[],appends:[],fields:{},filters:{},sorts:r,page:o.value.page,limit:o.value.rowsPerPage,payload:null,...o.value}).query();return c.superAdmin.getFacultyWithAdmin(e)},{refetchOnWindowFocus:!1,...m}),f=P(()=>{var i;return((i=l.data.value)==null?void 0:i.data)||[]}),d=P(()=>{var i,s;return((s=(i=l.data.value)==null?void 0:i.pagination)==null?void 0:s.total)||0});return{...l,items:f,totalItems:d}}const I=T({__name:"CreateSuperTeacher",props:{faculty:{type:Object,required:!0}},emits:["cancel","success"],setup(o,{emit:m}){const l=z({hodem:"",ten:"",maso:"",email:"",khoa_id:o.faculty.id,type:"teacher",ngay_sinh:null}),{$api:f,$toast:d}=C(),i=m,s=()=>{f.admin.createSuperTeacher(l).then(()=>{d.success("Tạo cán bộ khoa thành công"),i("success"),i("cancel")})};return(r,e)=>($(),w(S,{"can-cancel":"","cancel-text":"Hủy",title:`Tạo cán bộ ${o.faculty.ten}`,onCancel:e[5]||(e[5]=n=>i("cancel")),onSubmit:s},{default:t(()=>[a(V,{modelValue:u(l).hodem,"onUpdate:modelValue":e[0]||(e[0]=n=>u(l).hodem=n),label:"Họ đệm",name:"Họ đệm",rules:"required"},null,8,["modelValue"]),a(V,{modelValue:u(l).ten,"onUpdate:modelValue":e[1]||(e[1]=n=>u(l).ten=n),label:"Tên",name:"Tên",rules:"required"},null,8,["modelValue"]),a(V,{modelValue:u(l).email,"onUpdate:modelValue":e[2]||(e[2]=n=>u(l).email=n),label:"Email",name:"Email",rules:"required|email"},null,8,["modelValue"]),a(V,{modelValue:u(l).maso,"onUpdate:modelValue":e[3]||(e[3]=n=>u(l).maso=n),label:"Mã số",name:"Mã số",rules:"required"},null,8,["modelValue"]),a(V,{modelValue:u(l).ngay_sinh,"onUpdate:modelValue":e[4]||(e[4]=n=>u(l).ngay_sinh=n),label:"Ngày sinh",name:"Ngày sinh",rules:"required"},null,8,["modelValue"])]),_:1},8,["title"]))}}),L=T({__name:"ListSuperTeacher",props:{faculty:{type:Object,required:!0}},emits:["cancel"],setup(o,{emit:m}){z({hodem:"",ten:"",maso:"",email:"",khoa_id:o.faculty.id,type:"teacher"});const{$api:l,$toast:f}=C(),d=m,i=F(),s=[{title:"STT",align:"center",sortable:!1,key:"index",width:30},{title:"Tên giảng viên",key:"ten",minWidth:150},{title:"Mã số",key:"maso",width:"10%",minWidth:100},{title:"Hành động",key:"action",width:"30%",minWidth:350,align:"center"}],r=k=>{l.superAdmin.deleteSuperTeacher(k.id).then(()=>{f.success("Xóa cán bộ khoa thành công"),i.invalidateQueries("faculty-admins"),d("cancel")})},e=()=>{i.invalidateQueries("faculty-admins"),d("cancel")},n=k=>{l.admin.resetPassword(k.id).then(()=>{f.success("Reset mật khẩu thành công")})};return(k,v)=>($(),w(S,{"can-cancel":"","cancel-text":"Đóng","hide-submit":"",title:`Danh sách cán bộ ${o.faculty.ten}`,onCancel:v[0]||(v[0]=p=>d("cancel"))},{default:t(()=>[a(q,{"min-width":"400",width:"40%"},{activator:t(({props:p})=>[a(g,_(p,{class:"mb-4",color:"success",size:"small"}),{default:t(()=>v[1]||(v[1]=[h("Tạo cán bộ khoa")])),_:2},1040)]),default:t(({isActive:p})=>[a(I,{faculty:o.faculty,onCancel:U=>p.value=!1,onSuccess:e},null,8,["faculty","onCancel"])]),_:1}),o.faculty?($(),w(M,{key:0,headers:s,"hide-default-footer":"",items:o.faculty.teachers},{"item.index":t(({index:p})=>[y("span",null,x(p+1),1)]),"item.ten":t(({item:p})=>[y("span",null,x(p.hodem)+" "+x(p.ten),1)]),"item.action":t(({item:p})=>[a(g,{color:"primary",size:"small",class:"mr-2",onClick:U=>n(p)},{default:t(()=>[a(b,null,{default:t(()=>v[2]||(v[2]=[h("mdi-refresh")])),_:1}),v[3]||(v[3]=y("span",null,"Reset mật khẩu",-1))]),_:2},1032,["onClick"]),a(g,{color:"error",size:"small",onClick:U=>r(p)},{default:t(()=>v[4]||(v[4]=[h("Xóa")])),_:2},1032,["onClick"])]),_:1},8,["items"])):N("",!0)]),_:1},8,["title"]))}}),G={class:"text-center text-warning"},K=T({__name:"DeleteFacultyConfirmDialog",props:{faculty:{type:Object,required:!0}},emits:["success"],setup(o,{emit:m}){const c=o,l=m,{$api:f,$toast:d}=C(),i=F(),s=()=>{f.faculty.deleteFaculty(c.faculty.id).then(()=>{d.success("Xóa khoa thành công"),i.invalidateQueries("faculty-admins"),l("success")})};return(r,e)=>($(),w(q,{"min-width":"400",width:"40%"},{activator:t(({props:n})=>[a(g,_(n,{color:"error",icon:"",size:"small",variant:"text"}),{default:t(()=>[a(b,null,{default:t(()=>e[0]||(e[0]=[h("mdi-trash-can")])),_:1})]),_:2},1040)]),default:t(({isActive:n})=>[a(S,{"can-cancel":"","cancel-text":"Hủy","submit-text":"Xóa",title:"Xác nhận xóa khoa",onCancel:k=>n.value=!1,onSubmit:s},{default:t(()=>[y("div",G,[y("span",null,[a(b,null,{default:t(()=>e[1]||(e[1]=[h("mdi-warning")])),_:1}),e[2]||(e[2]=h(" Xóa ")),y("strong",null,x(o.faculty.ten)+" - "+x(o.faculty.maso),1),e[3]||(e[3]=h(" khỏi hệ thống? "))])])]),_:2},1032,["onCancel"])]),_:1}))}}),J={class:"d-flex flex-column flex-grow-1 h-full"},Y={class:"d-flex items-center"},Z={class:"mt-2"},fe=T({__name:"faculty",setup(o){const m=[{title:"STT",align:"start",sortable:!1,key:"index",width:30},{title:"Tên khoa",key:"ten",minWidth:250},{title:"Mã khoa",key:"ma_khoa",width:"30%",minWidth:350},{title:"Cán bộ khoa",key:"super_teachers",width:"30%",minWidth:300,align:"center"},{title:"",key:"action",width:"10%",minWidth:100,sortable:!1,align:"center"}],c=A({page:1,rowsPerPage:25,sortBy:"-created_at",sortType:"asc"}),l=P(()=>({...c.value}));C();const{items:f,refetch:d}=R(l);return(i,s)=>($(),H("div",J,[s[6]||(s[6]=y("div",{class:"text-lg font-bold text-uppercase"},"Quản lý khoa",-1)),a(X,{class:"pa-3 h-full",color:"white",variant:"flat"},{default:t(()=>[y("div",Y,[a(q,{"min-width":"400",width:"40%"},{activator:t(({props:r})=>[a(g,_({color:"success",size:"small"},r),{default:t(()=>[a(b,null,{default:t(()=>s[1]||(s[1]=[h("mdi-plus")])),_:1}),s[2]||(s[2]=y("span",null,"Thêm mới Khoa",-1))]),_:2},1040)]),default:t(({isActive:r})=>[a(j,{onCancel:e=>r.value=!1},null,8,["onCancel"])]),_:1}),a(O),a(g,{icon:"",size:"x-small",variant:"text",onClick:s[0]||(s[0]=r=>u(d)())},{default:t(()=>[a(b,null,{default:t(()=>s[3]||(s[3]=[h("mdi-refresh")])),_:1})]),_:1})]),y("div",Z,[a(M,{headers:m,"hide-default-footer":"",items:u(f)},{"item.index":t(({index:r})=>[y("span",null,x(r+1),1)]),"item.super_teachers":t(({item:r})=>[a(q,{"min-width":"600",width:"60%"},{activator:t(({props:e})=>[a(g,_(e,{color:"success",size:"small"}),{default:t(()=>s[4]||(s[4]=[h("Cán bộ khoa")])),_:2},1040)]),default:t(({isActive:e})=>[a(L,{faculty:r,onCancel:n=>e.value=!1},null,8,["faculty","onCancel"])]),_:2},1024)]),"item.action":t(({item:r})=>[a(q,{"min-width":"400",width:"40%"},{activator:t(({props:e})=>[a(g,_(e,{color:"success",icon:"",size:"small",variant:"text"}),{default:t(()=>[a(b,null,{default:t(()=>s[5]||(s[5]=[h("mdi-pencil")])),_:1})]),_:2},1040)]),default:t(({isActive:e})=>[a(B,{topic:r,onCancel:n=>e.value=!1},null,8,["topic","onCancel"])]),_:2},1024),a(K,{faculty:r,onSuccess:u(d)},null,8,["faculty","onSuccess"])]),_:1},8,["items"])])]),_:1})]))}});export{fe as default};
