import{V as T,s as q}from"./BjJwH3M6.js";import{a as N,O as L,i as O,d as z,r as V,S as B,t as c,L as w,A as u,z as o,M as e,v as _,y as v,T as E,x as i,B as I,V as F,$ as P,N as Q,K as j,X as D,R as M,W as H}from"./DnX59DTt.js";import{A as S}from"./xu1TNwaV.js";import{_ as g}from"./DrdJpUx0.js";import{V as W}from"./CUMVGX2-.js";import{V as G,a as K,b as X,c as J}from"./CRlUn-AK.js";import"./CCyDcYN0.js";function Y(y,m){const{$api:f}=N(),d=L(["my-report-intern",y],()=>f.reportIntern.getReportInterns(),{refetchOnWindowFocus:!1,...m}),n=O(()=>{var a;return((a=d.data.value)==null?void 0:a.data)||{}});return{...d,items:n}}const Z={key:0},ee={class:"w-full text-center mb-4"},le=z({__name:"UpdateReportIntern",props:{item:{type:Object,required:!0}},emits:["success"],setup(y,{emit:m}){const f=y,d=V(!1),n=V({...f.item}),{$api:a,$toast:x}=N(),C=B(),$=m,U=()=>{a.reportIntern.updateReportIntern(n.value.id,q.serialize(n.value)).then(()=>{C.invalidateQueries("my-report-intern"),x.success("Cập nhật báo cáo thành công"),$("success")}).finally(()=>{d.value=!1})};return(R,s)=>(c(),w(S,null,{default:u(({handleSubmit:k})=>[o(g,{modelValue:e(n).week,"onUpdate:modelValue":s[0]||(s[0]=p=>e(n).week=p),class:"mb-5",label:"Tuần số",name:"Tuần số",rules:"required",type:"number"},null,8,["modelValue"]),e(n).file_name?(c(),_("div",Z,"* "+v(e(n).file_name),1)):E("",!0),o(T,{modelValue:e(n).file,"onUpdate:modelValue":s[1]||(s[1]=p=>e(n).file=p),accept:".doc,.docx,.pdf",clearable:"",label:"File báo cáo",name:"File báo cáo","prepend-icon":!1,"prepend-inner-icon":"mdi-paperclip","show-size":"",variant:"outlined",onChange:s[2]||(s[2]=p=>e(n).file_name="")},null,8,["modelValue"]),o(g,{modelValue:e(n).description,"onUpdate:modelValue":s[3]||(s[3]=p=>e(n).description=p),class:"mb-4",label:"Mô tả",name:"Mô tả",rules:"required",type:"textarea"},null,8,["modelValue"]),i("div",ee,[o(F,{color:"success",loading:e(d),size:"small",onClick:p=>k(U)},{default:u(()=>s[4]||(s[4]=[I("Nộp báo cáo")])),_:2},1032,["loading","onClick"])])]),_:1}))}}),ne={class:"d-flex flex-column flex-grow-1 h-full"},te={class:"w-full text-center mb-4"},oe={key:2},se={class:"d-flex w-full"},ae={class:"d-flex items-center"},re=["onClick"],be=z({__name:"report-intern",setup(y){const m=V(!1),f=V(!1),d=V(null),n=()=>({id:null,week:"",description:"",file:null}),a=P(n()),{$api:x,$toast:C}=N(),$=B(),U=()=>{m.value=!0,x.reportIntern.createReportIntern(q.serialize(a)).then(()=>{$.invalidateQueries("my-report-intern"),Object.assign(a,n()),C.success("Nộp báo cáo thành công")}).finally(()=>{m.value=!1})},R=b=>{x.reportIntern.downloadReportIntern(b.file_key).then(l=>{const t=URL.createObjectURL(new Blob([l])),r=document.createElement("a");r.href=t,r.setAttribute("download",b.file_name),document.body.appendChild(r),r.click()})},s=V([]),{items:k,totalItems:p,isLoading:ie,refetch:ue}=Y(),h=b=>{d.value=b,f.value=!0};return(b,l)=>(c(),_("div",ne,[l[8]||(l[8]=i("div",{class:"text-lg font-bold text-uppercase"},"Báo cáo tiến độ thực tập",-1)),o(W,{class:"pa-3 h-full overflow-y-scroll",color:"white",variant:"flat"},{default:u(()=>[e(f)?(c(),w(le,{key:0,item:e(d),onSuccess:l[0]||(l[0]=t=>f.value=!1)},null,8,["item"])):(c(),w(S,{key:1},{default:u(({handleSubmit:t})=>[o(g,{modelValue:e(a).week,"onUpdate:modelValue":l[1]||(l[1]=r=>e(a).week=r),class:"mb-5",label:"Tuần số",name:"Tuần số",rules:"required",type:"number"},null,8,["modelValue"]),o(T,{modelValue:e(a).file,"onUpdate:modelValue":l[2]||(l[2]=r=>e(a).file=r),accept:".doc,.docx,.pdf",clearable:"",label:"File báo cáo",name:"File báo cáo","prepend-icon":!1,"prepend-inner-icon":"mdi-paperclip","show-size":"",variant:"outlined"},null,8,["modelValue"]),o(g,{modelValue:e(a).description,"onUpdate:modelValue":l[3]||(l[3]=r=>e(a).description=r),class:"mb-4",label:"Mô tả",name:"Mô tả",rules:"required",type:"textarea"},null,8,["modelValue"]),i("div",te,[o(F,{color:"success",loading:e(m),size:"small",onClick:r=>t(U)},{default:u(()=>l[5]||(l[5]=[I("Nộp báo cáo")])),_:2},1032,["loading","onClick"])])]),_:1})),e(k)?(c(),_("div",oe,[o(G,{modelValue:e(s),"onUpdate:modelValue":l[4]||(l[4]=t=>Q(s)?s.value=t:null),multiple:""},{default:u(()=>[(c(!0),_(j,null,D(e(k),(t,r)=>(c(),w(K,{key:r},{default:u(()=>[o(X,null,{default:u(()=>[i("div",se,[i("span",null,"Tuần "+v(t.week),1),o(M),i("div",null,"Nộp lúc: "+v(e(H)(new Date(t==null?void 0:t.created_at),"dd/MM/yyyy HH:mm")),1)])]),_:2},1024),o(J,null,{default:u(()=>[i("div",ae,[i("div",null,[l[6]||(l[6]=I(" File báo cáo: ")),i("span",{class:"cursor-pointer underline text-blue-400",onClick:A=>R(t)},v(t.file_name),9,re)]),o(M),o(F,{color:"success",height:"20",icon:"mdi-pencil",size:"small",variant:"plain",onClick:A=>h(t)},null,8,["onClick"])]),i("div",null,[i("div",null,"Mô tả: "+v(t.description),1),l[7]||(l[7]=i("div",null,"Nhận xét của giảng viên:",-1)),i("div",null,v(t.comment),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"])])):E("",!0)]),_:1})]))}});export{be as default};
