import{a as T,O as M,i as U,d as N,$ as R,r as w,P as z,t as c,v,x as n,z as o,A as r,M as e,L as C,R as h,B as b,T as g,y as i,S as A,V as G}from"./sjUhAvvQ.js";import{f as _}from"./D-3jeY6D.js";import{_ as V}from"./ToVgvsDd.js";import{A as Q}from"./D6BUiA2n.js";import{_ as S}from"./Dvv_Qwqo.js";import{V as L}from"./Do9P-qNa.js";import{V as j}from"./tlA2e_jv.js";import"./DSh5UDuB.js";import"./DZ_F3gcz.js";import"./BgMVXyc4.js";import"./BHFGkcei.js";import"./BRtmg2Ro.js";import"./C5tCWyF6.js";import"./Cw6M3Hk1.js";function F(x,s){const{$api:f}=T(),d=M(["my-recommend-topic",x],()=>f.topic.getMyRecommendTopic(),{refetchOnWindowFocus:!1,...s}),u=U(()=>{var m;return((m=d.data.value)==null?void 0:m.data[0])||null});return{...d,items:u}}const O={class:"d-flex flex-column flex-grow-1 h-full"},D={class:"text-center"},E={key:1,class:"d-flex flex-column gap-4"},I={class:"d-flex"},P={key:0},ue=N({__name:"recommend-topic",setup(x){const s=R({ten:"",description:"",requirement:"",knowledge:"",teacher_id:null,status:"pending"}),{$api:f,$toast:d}=T(),u=w(!1),m=z(),q=()=>{if(u.value=!0,p.value){f.topic.updateRecommendTopic(l.value.id,s).then(()=>{d.success("Cập nhật đề tài thành công"),m.invalidateQueries("my-recommend-topic"),p.value=!1}).finally(()=>{u.value=!1});return}f.topic.createRecommendTopic(s).then(()=>{d.success("Đăng ký đề tài thành công"),m.invalidateQueries("my-recommend-topic")})},p=w(!1),$=()=>{p.value=!0,s.ten=l.value.ten,s.description=l.value.description,s.teacher_id=l.value.teacher_id,s.knowledge=l.value.knowledge},{items:l,isLoading:W,refetch:H}=F();return(J,t)=>(c(),v("div",O,[t[11]||(t[11]=n("div",{class:"text-lg font-bold text-uppercase"},"Đề xuất đề tài đồ án",-1)),o(L,{class:"pa-3 h-full",color:"white",variant:"flat"},{default:r(()=>{var k,y;return[!e(l)||e(p)?(c(),C(Q,{key:0},{default:r(({handleSubmit:B})=>[o(V,{modelValue:e(s).ten,"onUpdate:modelValue":t[0]||(t[0]=a=>e(s).ten=a),label:"Tên đề tài",name:"Tên đề tài",rules:"required"},null,8,["modelValue"]),o(V,{modelValue:e(s).description,"onUpdate:modelValue":t[1]||(t[1]=a=>e(s).description=a),label:"Mô tả",name:"Mô tả",rules:"required",type:"textarea"},null,8,["modelValue"]),o(S,{modelValue:e(s).teacher_id,"onUpdate:modelValue":t[2]||(t[2]=a=>e(s).teacher_id=a),class:"mb-4",label:"Giảng viên",name:"Giảng viên",rules:"required"},null,8,["modelValue"]),o(V,{modelValue:e(s).knowledge,"onUpdate:modelValue":t[3]||(t[3]=a=>e(s).knowledge=a),label:"Công nghệ sử dụng",name:"Công nghệ sử dụng",rules:"required"},null,8,["modelValue"]),n("div",D,[o(h,{color:"success",loading:e(u),size:"small",variant:"elevated",onClick:a=>B(q)},{default:r(()=>t[4]||(t[4]=[b(" Đăng ký ")])),_:2},1032,["loading","onClick"])])]),_:1})):g("",!0),e(l)&&!e(p)?(c(),v("div",E,[n("div",I,[o(j,{color:e(_).statusColor(e(l).status),size:"small",variant:"flat"},{default:r(()=>[n("span",null,i(e(_).statusType(e(l).status)),1)]),_:1},8,["color"]),o(A),e(l).status!="approved"?(c(),C(h,{key:0,color:"success",icon:"",size:"x-small",variant:"text",onClick:$},{default:r(()=>[o(G,null,{default:r(()=>t[5]||(t[5]=[b("mdi-pencil")])),_:1})]),_:1})):g("",!0)]),n("div",null,[t[6]||(t[6]=n("span",{class:"font-weight-bold mr-2"},"Tên đề tài đề xuất:",-1)),n("span",null,i(e(l).ten),1)]),n("div",null,[t[7]||(t[7]=n("span",{class:"font-weight-bold mr-2"},"Mô tả:",-1)),n("span",null,i(e(l).description),1)]),n("div",null,[t[8]||(t[8]=n("span",{class:"font-weight-bold mr-2"},"Giảng viên:",-1)),n("span",null,i((k=e(l).teacher)==null?void 0:k.hodem)+" "+i((y=e(l).teacher)==null?void 0:y.ten),1)]),n("div",null,[t[9]||(t[9]=n("span",{class:"font-weight-bold mr-2"},"Công nghệ sử dụng:",-1)),n("span",null,i(e(l).knowledge),1)]),e(l).status=="rejected"?(c(),v("div",P,[t[10]||(t[10]=n("span",{class:"font-weight-bold mr-2"},"Lý do từ chối đề tài:",-1)),n("span",null,i(e(l).reject_reason),1)])):g("",!0)])):g("",!0)]}),_:1})]))}});export{ue as default};
