import{_ as y}from"./BtS7m9iX.js";import{V as A,s as F}from"./tiE9t01t.js";import{d as q,r as k,a as C,P as L,t as x,L as M,A as l,M as n,v as _,x as p,z as t,B as g,V as S,y as b,N as E,R as $,Q as T,O as R,i as D,S as j,W as X}from"./CqP_eWgs.js";import{r as J,u as O}from"./DG2X6oDA.js";import{_ as z}from"./K1KuR4TM.js";import{V as G}from"./DasNMYfy.js";import{V as U}from"./DtRgzco-.js";import{P as K,_ as W}from"./DZ_F3gcz.js";import{V as Y}from"./B_0wuXyI.js";import{V as Z}from"./DmrsZ6zT.js";import"./Debhx5xt.js";import"./DONM5gkJ.js";import"./DNAAebiG.js";import"./BN51xDYQ.js";import"./CeLOGc9e.js";import"./R27po0-W.js";const ee={key:0},te={class:"d-flex items-center"},ne={key:0},le={key:1},se={key:0},ae={key:1},ie={key:0},oe={key:1},re={key:1},ue={class:"mt-4"},de={class:"max-w-[520px] ma-auto d-flex"},me={class:"d-none"},pe=q({__name:"ImportStudentIntern",emits:["cancel","success"],setup(d,{emit:v}){const s=k(null),{$api:i,$toast:V}=C(),f=v,c=L(),h=k(!1),m=k(!1),u=[{title:"STT",align:"center",sortable:!1,key:"index",width:50},{title:"Sinh viên",key:"ten",width:"20%",minWidth:200},{title:"Mã số",key:"maso",minWidth:100},{title:"Email",key:"email",minWidth:100},{title:"Ngày sinh",key:"ngay_sinh",minWidth:100},{title:"Lớp",key:"lop",width:"15%",minWidth:100,align:"center"}],e=()=>{i.studentIntern.importStudentIntern(F.serialize({file:s.value})).then(I=>{if(I.size>2106){V.error("Dữ liệu không hợp lệ, vui lòng kiểm tra lại!");const o=URL.createObjectURL(new Blob([I])),r=document.createElement("a");r.href=o,r.setAttribute("download","error_student.xlsx"),document.body.appendChild(r),r.click()}else V.success("Import sinh viên thành công");c.invalidateQueries("student-intern"),f("cancel"),f("success")}).finally(()=>{m.value=!1})},a=["STT","maso","hodem","ten","ngay_sinh","lop","email"],w=k([]),H=()=>{const I=new FileReader;if(s.value){if(s.value.size>5*1024*1024){V.error("File phải nhỏ hơn 5MB");return}I.onload=o=>{var r;if((r=o.target)!=null&&r.result){const N=J(o.target.result,{type:"binary",cellDates:!0}),P=N.Sheets[N.SheetNames[0]],B=O.sheet_to_json(P,{header:1})[0];if(JSON.stringify(B)!==JSON.stringify(a)){V.error("File không đúng định dạng");return}const Q=O.sheet_to_json(P);h.value=!0,w.value=Q}},I.readAsBinaryString(s.value)}};return(I,o)=>(x(),M(z,{"can-cancel":"","cancel-text":"Hủy","hide-submit":!n(h),title:"Import sinh viên thực tập",onCancel:o[2]||(o[2]=r=>f("cancel")),onSubmit:e},{default:l(()=>[n(h)?(x(),_("div",ee,[p("div",te,[t(S,{class:"ma-2",color:"error"},{default:l(()=>o[3]||(o[3]=[g("mdi-alert-circle")])),_:1}),o[4]||(o[4]=p("span",null,"Dữ liệu không hợp lệ có thể không được lưu!",-1))]),t(G,{headers:u,height:"400","item-value":"name",items:n(w)},{"item.index":l(({index:r})=>[p("span",null,b(r+1),1)]),"item.ten":l(({item:r})=>[r.hodem&&r.ten?(x(),_("span",ne,b(r.hodem+" "+r.ten),1)):(x(),_("span",le,[t(S,{color:"error"},{default:l(()=>o[5]||(o[5]=[g("mdi-alert-circle")])),_:1})]))]),"item.maso":l(({item:r})=>[r.maso?(x(),_("span",se,b(r.maso),1)):(x(),_("span",ae,[t(S,{color:"error"},{default:l(()=>o[6]||(o[6]=[g("mdi-alert-circle")])),_:1})]))]),"item.email":l(({item:r})=>[r.email?(x(),_("span",ie,b(r.email),1)):(x(),_("span",oe,[t(S,{color:"error"},{default:l(()=>o[7]||(o[7]=[g("mdi-alert-circle")])),_:1})]))]),_:1},8,["items"])])):(x(),_("div",re,[o[9]||(o[9]=p("div",{class:"mt-5"},[g(" Tải xuống mẫu import dữ liệu: "),p("a",{download:"",href:"/files/student_intern_template.xlsx",target:"_blank"},"download")],-1)),p("div",ue,[p("div",de,[t(A,{modelValue:n(s),"onUpdate:modelValue":o[0]||(o[0]=r=>E(s)?s.value=r:null),accept:".xlsx",class:"w-full mr-4",label:"File dữ liệu",variant:"outlined"},null,8,["modelValue"]),p("div",me,[t(y,{modelValue:n(s),"onUpdate:modelValue":o[1]||(o[1]=r=>E(s)?s.value=r:null),rules:"required"},null,8,["modelValue"])]),t($,{color:"success",disabled:!n(s),onClick:H},{default:l(()=>o[8]||(o[8]=[g("Xem trước")])),_:1},8,["disabled"])])])]))]),_:1},8,["hide-submit"]))}}),ce=q({__name:"CreateStudentIntern",emits:["cancel","success"],setup(d,{emit:v}){const s=k({hodem:"",ten:"",email:"",maso:"",lop:"",phone:""}),{$api:i,$toast:V}=C(),f=v,c=L(),h=()=>{i.admin.createStudentIntern(s.value).then(()=>{V.success("Thêm mới sinh viên thực tập thành công"),c.invalidateQueries("student-intern"),f("success"),f("cancel")})};return(m,u)=>(x(),M(z,{"can-cancel":"","cancel-text":"Hủy",title:"Thêm mới sinh viên thực tập",onCancel:u[6]||(u[6]=e=>f("cancel")),onSubmit:h},{default:l(()=>[t(y,{modelValue:n(s).hodem,"onUpdate:modelValue":u[0]||(u[0]=e=>n(s).hodem=e),label:"Họ đệm",name:"Họ đệm",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(s).ten,"onUpdate:modelValue":u[1]||(u[1]=e=>n(s).ten=e),label:"Tên sinh viên",name:"Tên sinh viên",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(s).maso,"onUpdate:modelValue":u[2]||(u[2]=e=>n(s).maso=e),label:"Mã số",name:"Mã số",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(s).email,"onUpdate:modelValue":u[3]||(u[3]=e=>n(s).email=e),label:"Email",name:"Email",rules:"required|email"},null,8,["modelValue"]),t(y,{modelValue:n(s).lop,"onUpdate:modelValue":u[4]||(u[4]=e=>n(s).lop=e),label:"Lớp",name:"Lớp",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(s).phone,"onUpdate:modelValue":u[5]||(u[5]=e=>n(s).phone=e),label:"Số điện thoại",name:"Số điện thoại"},null,8,["modelValue"])]),_:1}))}}),fe=q({__name:"UpdateStudentIntern",props:{studentIntern:{type:Object,required:!0,hodem:"",ten:"",email:"",maso:"",lop:"",phone:""}},emits:["cancel","success"],setup(d,{emit:v}){const i=k({...d.studentIntern}),{$api:V,$toast:f}=C(),c=v,h=L(),m=()=>{V.admin.updateStudentIntern(i.value.id,i.value).then(()=>{f.success("Cập nhật sinh viên thực tập thành công"),h.invalidateQueries("student-intern"),c("success"),c("cancel")})};return(u,e)=>(x(),M(z,{"can-cancel":"","cancel-text":"Hủy",title:"Cập nhật sinh viên thực tập",onCancel:e[6]||(e[6]=a=>c("cancel")),onSubmit:m},{default:l(()=>[t(y,{modelValue:n(i).hodem,"onUpdate:modelValue":e[0]||(e[0]=a=>n(i).hodem=a),label:"Họ đệm",name:"Họ đệm",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(i).ten,"onUpdate:modelValue":e[1]||(e[1]=a=>n(i).ten=a),label:"Tên sinh viên",name:"Tên sinh viên",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(i).maso,"onUpdate:modelValue":e[2]||(e[2]=a=>n(i).maso=a),label:"Mã số",name:"Mã số",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(i).email,"onUpdate:modelValue":e[3]||(e[3]=a=>n(i).email=a),label:"Email",name:"Email",rules:"required|email"},null,8,["modelValue"]),t(y,{modelValue:n(i).lop,"onUpdate:modelValue":e[4]||(e[4]=a=>n(i).lop=a),label:"Lớp",name:"Lớp",rules:"required"},null,8,["modelValue"]),t(y,{modelValue:n(i).phone,"onUpdate:modelValue":e[5]||(e[5]=a=>n(i).phone=a),label:"Số điện thoại",name:"Số điện thoại"},null,8,["modelValue"])]),_:1}))}}),he={class:"text-center text-warning"},ve=q({__name:"DeleteStudentInternConfirmDialog",props:{studentIntern:{type:Object,required:!0}},emits:["success"],setup(d,{emit:v}){const s=d,i=v,{$api:V,$toast:f}=C(),c=()=>{V.admin.deleteStudentIntern(s.studentIntern.id).then(()=>{f.success("Xóa sinh viên thực tập thành công"),i("success")})};return(h,m)=>(x(),M(U,{"min-width":"400",width:"40%"},{activator:l(({props:u})=>[t($,T(u,{color:"error",icon:"",size:"small",variant:"text"}),{default:l(()=>[t(S,null,{default:l(()=>m[0]||(m[0]=[g("mdi-trash-can")])),_:1})]),_:2},1040)]),default:l(({isActive:u})=>[t(z,{"can-cancel":"","cancel-text":"Hủy","submit-text":"Xóa",title:"Xác nhận xóa sinh viên thực tập",onCancel:e=>u.value=!1,onSubmit:c},{default:l(()=>[p("div",he,[p("span",null,[t(S,null,{default:l(()=>m[1]||(m[1]=[g("mdi-warning")])),_:1}),m[2]||(m[2]=g(" Xóa sinh viên ")),p("strong",null,b(d.studentIntern.hodem)+" "+b(d.studentIntern.ten)+" - "+b(d.studentIntern.maso),1),m[3]||(m[3]=g(" khỏi hệ thống? "))])])]),_:2},1032,["onCancel"])]),_:1}))}});function Ve(d,v){return d?Array.isArray(d)?W.map(W.zip(d,v),([s,i])=>i==="desc"?`-${s}`:s):[v==="desc"?`-${d}`:d]:[]}function ye(d,v){const{$api:s}=C(),i=R(["student-intern",d],()=>{const{sortBy:c,sortType:h}=d.value,m=Ve(c,h),u=new K({includes:[],appends:[],fields:{},filters:{},sorts:m,page:d.value.page,limit:d.value.rowsPerPage,payload:null,...d.value}).query();return s.studentIntern.getStudentInterns(u)},{refetchOnWindowFocus:!1,...v}),V=D(()=>{var c;return((c=i.data.value)==null?void 0:c.data)||[]}),f=D(()=>{var c,h;return((h=(c=i.data.value)==null?void 0:c.pagination)==null?void 0:h.total)||0});return{...i,items:V,totalItems:f}}const ge={class:"d-flex flex-column flex-grow-1 h-full"},xe={class:"d-flex items-center"},Se={class:"mt-2 h-[calc(100%_-_45px)]"},Pe=q({__name:"student-company",setup(d){const v=[{title:"STT",align:"center",sortable:!1,key:"index",width:50},{title:"Tên sinh viên",key:"ten"},{title:"Mã số",key:"maso"},{title:"Email",key:"email"},{title:"Lớp",key:"lop",width:"15%",minWidth:150},{title:"",key:"action",width:100}],s=k({q:""}),i=k({page:1,rowsPerPage:100,sortBy:"-created_at",sortType:"asc"}),V=D(()=>({...i.value}));C();const{items:f,totalItems:c,isLoading:h,refetch:m}=ye(V);return(u,e)=>(x(),_("div",ge,[e[8]||(e[8]=p("div",{class:"text-lg font-bold text-uppercase"},"Quản lý sinh viên thực tập",-1)),t(Y,{class:"px-3 py-2 h-full",color:"white",variant:"flat"},{default:l(()=>[p("div",xe,[t(U,{"min-width":"600",width:"60%"},{activator:l(({props:a})=>[t($,T({color:"success",size:"small"},a),{default:l(()=>[t(S,null,{default:l(()=>e[2]||(e[2]=[g("mdi-plus")])),_:1}),e[3]||(e[3]=p("span",null,"Import",-1))]),_:2},1040)]),default:l(({isActive:a})=>[t(pe,{onCancel:w=>a.value=!1},null,8,["onCancel"])]),_:1}),t(y,{modelValue:n(s).q,"onUpdate:modelValue":e[0]||(e[0]=a=>n(s).q=a),class:"h-[24px] w-[250px] ml-2",clearable:"",density:"compact",placeholder:"Tên/Mã số sinh viên","prepend-inner-icon":"mdi-magnify",variant:"plain"},null,8,["modelValue"]),t(j),t(U,{"min-width":"400",width:"40%"},{activator:l(({props:a})=>[t($,T({color:"success",size:"small"},a),{default:l(()=>[t(S,null,{default:l(()=>e[4]||(e[4]=[g("mdi-plus")])),_:1}),e[5]||(e[5]=p("span",null,"Thêm sinh viên",-1))]),_:2},1040)]),default:l(({isActive:a})=>[t(ce,{onCancel:w=>a.value=!1,onSuccess:n(m)},null,8,["onCancel","onSuccess"])]),_:1}),t($,{icon:"",size:"x-small",variant:"text",onClick:e[1]||(e[1]=a=>n(m)())},{default:l(()=>[t(S,null,{default:l(()=>e[6]||(e[6]=[g("mdi-refresh")])),_:1})]),_:1})]),p("div",Se,[t(Z,{class:"h-full","fixed-header":"",headers:v,"hide-default-footer":"",items:n(f),"items-per-page":1e3,loading:n(h)},{"item.index":l(({index:a})=>[p("span",null,b(a+1),1)]),"item.ten":l(({item:a})=>[p("span",null,b(a.hodem+" "+a.ten),1)]),"item.ngay_sinh":l(({item:a})=>[p("span",null,b(n(X)(new Date(a.ngay_sinh),"dd/MM/yyyy")),1)]),"item.action":l(({item:a})=>[t(U,{"min-width":"400",width:"40%"},{activator:l(({props:w})=>[t($,T(w,{color:"success",icon:"",size:"small",variant:"text"}),{default:l(()=>[t(S,null,{default:l(()=>e[7]||(e[7]=[g("mdi-pencil")])),_:1})]),_:2},1040)]),default:l(({isActive:w})=>[t(fe,{"student-intern":a,onCancel:H=>w.value=!1},null,8,["student-intern","onCancel"])]),_:2},1024),t(ve,{"student-intern":a,onSuccess:n(m)},null,8,["student-intern","onSuccess"])]),_:1},8,["items","loading"])])]),_:1})]))}});export{Pe as default};
