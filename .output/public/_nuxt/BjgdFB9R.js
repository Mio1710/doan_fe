import{a as $,O as N,i as k,d as C,J as O,r as w,t as V,v as z,z as l,M as e,$ as G,P as W,L as T,A as i,V as U,B as b,Q as q,R as E,x as f,Z as H,T as I,S as Q,y as S}from"./B4b9T3Ey.js";import{_ as A}from"./DWnP-3Ud.js";import{_ as h}from"./CrJ5cAV7.js";import{P as j,_ as B}from"./DZ_F3gcz.js";import{V as L}from"./BNWmDkMe.js";import{V as P}from"./CVw9Z0pi.js";import{u as M}from"./CIxHwz1E.js";import{V as F}from"./Bix--L3c.js";import{V as R}from"./CBRjQWUi.js";import{V as X}from"./voTx8pFo.js";import"./-Uj72WA5.js";import"./BGjOXY4c.js";import"./DYIKh2sd.js";import"./DyB1R29R.js";import"./CYp3WHDJ.js";import"./Dcg_XI_i.js";function J(o,p){return o?Array.isArray(o)?B.map(B.zip(o,p),([a,t])=>t==="desc"?`-${a}`:a):[p==="desc"?`-${o}`:o]:[]}function Z(o,p){const{$api:a}=$(),t=N(["student-teacher",o],()=>{const{sortBy:r,sortType:m}=o.value,c=J(r,m),s=new j({includes:[],appends:[],fields:{},filters:{},sorts:c,page:o.value.page,limit:o.value.rowsPerPage,payload:null,...o.value}).query();return a.studentTeacher.getTeachers(s)},{refetchOnWindowFocus:!1,...p}),y=k(()=>{var r;return((r=t.data.value)==null?void 0:r.data)||[]}),g=k(()=>{var r,m;return((m=(r=t.data.value)==null?void 0:r.pagination)==null?void 0:m.total)||0});return{...t,items:y,totalItems:g}}const K=C({__name:"StudentTeacherAutocomplete",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(o){const p=O(o,"modelValue");w("");const a=w({page:1,rowsPerPage:100,sortBy:"-created_at",sortType:"asc"}),t=k(()=>({...a.value})),y=m=>`${m.hodem} ${m.ten}`,{items:g,isLoading:r}=Z(t);return(m,c)=>(V(),z("div",null,[l(L,{modelValue:p.value,"onUpdate:modelValue":c[0]||(c[0]=s=>p.value=s),chips:"","closable-chips":"","item-title":y,"item-value":"id",items:e(g),label:"Giảng viên hướng dẫn",loading:e(r)},null,8,["modelValue","items","loading"])]))}}),Y=C({__name:"CreateIntern",emits:["cancel"],setup(o,{emit:p}){const a=G({company_name:"",address:"",company_phone:"",company_email:"",supervisor_name:"",supervisor_phone:"",supervisor_email:"",teacher_id:[]}),{$api:t,$toast:y}=$(),g=p,r=W(),m=()=>{t.intern.createIntern(a).then(()=>{y.success("Đăng ký thực tập thành công"),r.invalidateQueries("intern"),g("cancel")})};return(c,s)=>(V(),T(A,{"can-cancel":"","cancel-text":"Hủy",title:"Đăng ký thưc tập",onCancel:s[8]||(s[8]=n=>g("cancel")),onSubmit:m},{default:i(()=>[l(h,{modelValue:e(a).company_name,"onUpdate:modelValue":s[0]||(s[0]=n=>e(a).company_name=n),label:"Tên công ty",name:"Tên công ty",rules:"required"},null,8,["modelValue"]),l(h,{modelValue:e(a).company_email,"onUpdate:modelValue":s[1]||(s[1]=n=>e(a).company_email=n),label:"Emai công ty",name:"Emai công ty",type:"textarea"},null,8,["modelValue"]),l(h,{modelValue:e(a).company_phone,"onUpdate:modelValue":s[2]||(s[2]=n=>e(a).company_phone=n),label:"SĐT công ty",name:"SĐT công ty"},null,8,["modelValue"]),l(h,{modelValue:e(a).address,"onUpdate:modelValue":s[3]||(s[3]=n=>e(a).address=n),label:"Địa chỉ công ty",name:"Địa chỉ công ty"},null,8,["modelValue"]),l(h,{modelValue:e(a).supervisor_name,"onUpdate:modelValue":s[4]||(s[4]=n=>e(a).supervisor_name=n),label:"Tên người hướng dẫn",name:"Tên người hướng dẫn"},null,8,["modelValue"]),l(h,{modelValue:e(a).supervisor_phone,"onUpdate:modelValue":s[5]||(s[5]=n=>e(a).supervisor_phone=n),label:"Số điện thoại người hướng dẫn",name:"Số điện thoại người hướng dẫn"},null,8,["modelValue"]),l(h,{modelValue:e(a).supervisor_email,"onUpdate:modelValue":s[6]||(s[6]=n=>e(a).supervisor_email=n),label:"Email người hướng dẫn",name:"Email người hướng dẫn"},null,8,["modelValue"]),l(K,{modelValue:e(a).teacher_id,"onUpdate:modelValue":s[7]||(s[7]=n=>e(a).teacher_id=n),name:"Giảng viên",rules:"required"},null,8,["modelValue"])]),_:1}))}}),D={statusColor(o){switch(o){case"pending":return"info";case"approved":return"success";case"rejected":return"error";default:return"#ccc"}},statusType(o){switch(o){case"pending":return"Chờ duyệt";case"approved":return"Đã duyệt";case"rejected":return"Từ chối";default:return"Chờ duyệt"}}},ee=C({__name:"UpdateIntern",props:{intern:{type:Object,required:!0,teacher_id:[],company_name:"",address:"",company_phone:"",company_email:"",supervisor_name:"",supervisor_phone:"",supervisor_email:""}},emits:["cancel"],setup(o,{emit:p}){const t=w({...o.intern}),{$api:y,$toast:g}=$(),r=p,m=W(),c=()=>{t.value.status="pending",y.intern.updateIntern(t.value.id,t.value).then(()=>{g.success("Cập nhật thành công"),m.invalidateQueries("intern"),r("cancel")})};return(s,n)=>(V(),T(A,{"can-cancel":"","cancel-text":"Hủy",title:"Cập nhật thông tin thực tập",onCancel:n[7]||(n[7]=d=>r("cancel")),onSubmit:c},{default:i(()=>[l(h,{modelValue:e(t).company_name,"onUpdate:modelValue":n[0]||(n[0]=d=>e(t).company_name=d),label:"Tên công ty",name:"Tên công ty",rules:"required"},null,8,["modelValue"]),l(h,{modelValue:e(t).company_email,"onUpdate:modelValue":n[1]||(n[1]=d=>e(t).company_email=d),label:"Email công ty",name:"Emai công ty",type:"textarea"},null,8,["modelValue"]),l(h,{modelValue:e(t).company_phone,"onUpdate:modelValue":n[2]||(n[2]=d=>e(t).company_phone=d),label:"SĐT công ty",name:"SĐT công ty"},null,8,["modelValue"]),l(h,{modelValue:e(t).address,"onUpdate:modelValue":n[3]||(n[3]=d=>e(t).address=d),label:"Địa chỉ công ty",name:"Địa chỉ công ty"},null,8,["modelValue"]),l(h,{modelValue:e(t).supervisor_name,"onUpdate:modelValue":n[4]||(n[4]=d=>e(t).supervisor_name=d),label:"Tên người hướng dẫn",name:"Tên người hướng dẫn"},null,8,["modelValue"]),l(h,{modelValue:e(t).supervisor_phone,"onUpdate:modelValue":n[5]||(n[5]=d=>e(t).supervisor_phone=d),label:"Số điện thoại người hướng dẫn",name:"Số điện thoại người hướng dẫn"},null,8,["modelValue"]),l(h,{modelValue:e(t).supervisor_email,"onUpdate:modelValue":n[6]||(n[6]=d=>e(t).supervisor_email=d),label:"Email người hướng dẫn",name:"Email người hướng dẫn"},null,8,["modelValue"])]),_:1}))}}),ne={class:"text-center text-warning"},te=C({__name:"DeleteIntern",props:{intern:{type:Object,required:!0}},emits:["success","cancel"],setup(o,{emit:p}){const a=o,t=p,{$api:y,$toast:g}=$(),r=()=>{console.log("Deleting intern with ID:",a.intern.id),y.intern.deleteIntern(a.intern.id).then(()=>{g.success("Hủy đăng ký thực tập thành công"),t("success"),t("cancel")}).catch(m=>{g.error("Có lỗi xảy ra khi hủy đăng ký thực tập"),console.error(m)})};return(m,c)=>(V(),T(P,{"min-width":"400",width:"40%"},{activator:i(({props:s})=>[l(E,q(s,{color:"error",icon:"",size:"small",variant:"text"}),{default:i(()=>[l(U,null,{default:i(()=>c[0]||(c[0]=[b("mdi-trash-can")])),_:1})]),_:2},1040)]),default:i(({isActive:s})=>[l(A,{"can-cancel":"","cancel-text":"Hủy","submit-text":"Xóa",title:"Xác nhận hủy đăng ký thực tập",onCancel:n=>s.value=!1,onSubmit:r},{default:i(()=>[f("div",ne,[f("span",null,[l(U,null,{default:i(()=>c[1]||(c[1]=[b("mdi-warning")])),_:1}),c[2]||(c[2]=b(" Bạn có chắc chắn muốn hủy đăng ký thực tập không? "))])])]),_:2},1032,["onCancel"])]),_:1}))}}),ae={class:"d-flex flex-column flex-grow-1 h-full"},le={class:"d-flex items-center"},se={class:"mt-2 h-[calc(100%-_45px)] overflow-y-hidden"},xe=C({__name:"company",setup(o){w(!1),w("");const p=[{title:"Tên công ty",key:"company_name",width:"15%",minWidth:150},{title:"Địa chỉ",key:"address",width:"15%",minWidth:150},{title:"Email công ty",key:"company_email",width:"10%",minWidth:100},{title:"SĐT công ty",key:"company_phone",width:"10%",minWidth:100},{title:"Tên người hướng dẫn",key:"supervisor_name",width:"10%",minWidth:100},{title:"SĐT người hướng dẫn",key:"supervisor_phone",width:"10%",minWidth:100},{title:"Email người hướng dẫn",key:"supervisor_email",width:"10%",minWidth:100},{title:"GVHD",key:"teacher",width:"10%",minWidth:100},{title:"Trạng thái",key:"status",width:"10%",minWidth:100,align:"center"},{title:"",key:"action",width:30}],a=w({page:1,rowsPerPage:25,sortBy:"-created_at",sortType:"asc"}),t=w({viewAll:!1}),y=k(()=>({...a.value,filters:t.value}));$();const{data:g}=H();W();const{items:r,totalItems:m,isLoading:c,refetch:s}=M(y),n=k(()=>r.value.some(d=>d.student.id===g.value.id));return(d,v)=>(V(),z("div",ae,[v[3]||(v[3]=f("div",{class:"text-lg font-bold text-uppercase"},"Thực tập doanh nghiệp",-1)),l(F,{class:"pa-3 h-full",color:"white",variant:"flat"},{default:i(()=>[f("div",le,[l(P,{"min-width":"400",width:"40%"},{activator:i(({props:u})=>[e(n)?I("",!0):(V(),T(E,q({key:0,color:"success",size:"small"},u),{default:i(()=>[l(U,null,{default:i(()=>v[0]||(v[0]=[b("mdi-plus")])),_:1}),v[1]||(v[1]=f("span",null,"Đăng ký thực tập",-1))]),_:2},1040))]),default:i(({isActive:u})=>[l(Y,{onCancel:_=>u.value=!1},null,8,["onCancel"])]),_:1}),l(Q)]),f("div",se,[l(R,{class:"h-full","fixed-header":"",headers:p,items:e(r)},{"item.index":i(({index:u})=>[f("span",null,S(u+1),1)]),"item.teacher":i(({item:u})=>{var _,x;return[f("span",null,S((_=u.teacher)==null?void 0:_.hodem)+" "+S((x=u.teacher)==null?void 0:x.ten),1)]}),"item.status":i(({item:u})=>[l(X,{color:e(D).statusColor(u.status),size:"small",variant:"flat"},{default:i(()=>[b(S(e(D).statusType(u.status)),1)]),_:2},1032,["color"])]),"item.action":i(({item:u})=>[l(P,{"min-width":"400",width:"40%"},{activator:i(({props:_})=>{var x;return[((x=e(g))==null?void 0:x.id)==u.student.id?(V(),T(E,q({key:0},_,{color:"success",disabled:u.status=="approved"||!u.status,icon:"",size:"small",variant:"text"}),{default:i(()=>[l(U,null,{default:i(()=>v[2]||(v[2]=[b("mdi-pencil")])),_:1})]),_:2},1040,["disabled"])):I("",!0)]}),default:i(({isActive:_})=>[l(ee,{intern:u,onCancel:x=>_.value=!1},null,8,["intern","onCancel"])]),_:2},1024),u.status=="pending"?(V(),T(te,{key:0,intern:u,onSuccess:e(s)},null,8,["intern","onSuccess"])):I("",!0)]),_:1},8,["items"])])]),_:1})]))}});export{xe as default};
