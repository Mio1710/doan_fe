import{_ as C}from"./1adOK-vi.js";import{_ as $}from"./BjrrArms.js";import{d as x,J as z,t as V,v as k,z as l,K as D,r as T,a as g,L as S,A as a,M as d,N as q,O as F,i as B,P as N,V as h,B as _,Q as b,R as y,x as f,y as H,S as W}from"./CFiehynL.js";import{V as w}from"./DnFUZBxv.js";import{V as P}from"./DBYuLB8G.js";import{V as Q}from"./CZ9s_aoN.js";import"./nflsgOpI.js";import"./VaKneH-D.js";import"./CISklGHC.js";import"./CN8nOB4F.js";import"./BBJD5s-R.js";import"./D00urTNM.js";const U=x({__name:"LOForm",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(i){const n=z(i,"modelValue");return(p,e)=>(V(),k(D,null,[l($,{modelValue:n.value.main_criteria,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value.main_criteria=o),label:"Tiêu chí đánh giá",name:"Tiêu chí đánh giá",rules:"required",type:"textarea"},null,8,["modelValue"]),l($,{modelValue:n.value.sub_criteria,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.sub_criteria=o),label:"Tiêu chí phụ",name:"Tiêu chí phụ",rules:"required",type:"textarea"},null,8,["modelValue"]),l($,{modelValue:n.value.cof,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.cof=o),label:"Hệ số",name:"Hệ số",placeholder:"0.3...",rules:"required|max:10",type:"number"},null,8,["modelValue"])],64))}}),X=x({__name:"CreateLO",props:{lo:{type:Object,default:()=>({main_criteria:"",sub_criteria:"",cof:null})}},emits:["cancel","success"],setup(i,{emit:n}){const e=T({...i.lo}),{$api:o,$toast:c}=g(),r=n,u=()=>{e.value.cof=parseFloat(e.value.cof),o.lo.createLO(e.value).then(()=>{c.success("Thêm LO thành công"),r("success"),r("cancel")})};return(v,s)=>(V(),S(C,{"can-cancel":"","cancel-text":"Hủy",title:"Thêm LO",onCancel:s[1]||(s[1]=t=>r("cancel")),onSubmit:u},{default:a(()=>[l(U,{modelValue:d(e),"onUpdate:modelValue":s[0]||(s[0]=t=>q(e)?e.value=t:null)},null,8,["modelValue"])]),_:1}))}});function j(i,n){const{$api:p}=g(),e=F(["list-lo",i],()=>p.lo.getLOs(),{refetchOnWindowFocus:!1,...n}),o=B(()=>{var c;return((c=e.data.value)==null?void 0:c.data)||[]});return{...e,items:o}}const M=x({__name:"UpdateLO",props:{lo:{type:Object,required:!0}},emits:["cancel","success"],setup(i,{emit:n}){const e=T({...i.lo}),{$api:o,$toast:c}=g(),r=n,u=()=>{e.value.cof=parseFloat(e.value.cof),o.lo.updateLO(e.value.id,e.value).then(()=>{c.success("Chỉnh sửa LO thành công"),r("success"),r("cancel")})};return(v,s)=>(V(),S(C,{"can-cancel":"","cancel-text":"Hủy",title:"Chỉnh sửa LO",onCancel:s[1]||(s[1]=t=>r("cancel")),onSubmit:u},{default:a(()=>[l(U,{modelValue:d(e),"onUpdate:modelValue":s[0]||(s[0]=t=>q(e)?e.value=t:null)},null,8,["modelValue"])]),_:1}))}}),R={class:"text-center text-warning"},I=x({__name:"DeleteLOConfirmDialog",props:{lo:{type:Object,required:!0}},emits:["success"],setup(i,{emit:n}){const p=i,e=n,{$api:o,$toast:c}=g(),r=N(),u=v=>{o.lo.deleteLO(p.lo.id).then(()=>{c.success("Xóa LO thành công"),r.invalidateQueries("lo"),v.value=!1,e("success")})};return(v,s)=>(V(),S(w,{"min-width":"400",width:"40%"},{activator:a(({props:t})=>[l(y,b(t,{color:"error",icon:"",size:"small",variant:"text"}),{default:a(()=>[l(h,null,{default:a(()=>s[0]||(s[0]=[_("mdi-trash-can")])),_:1})]),_:2},1040)]),default:a(({isActive:t})=>[l(C,{"can-cancel":"","cancel-text":"Hủy","submit-text":"Xóa",title:"Xác nhận xóa LO",onCancel:L=>t.value=!1,onSubmit:L=>u(t)},{default:a(()=>[f("div",R,[f("span",null,[l(h,null,{default:a(()=>s[1]||(s[1]=[_("mdi-warning")])),_:1}),s[2]||(s[2]=_(" Xóa LO ")),f("strong",null,H(i.lo.main_criteria),1),s[3]||(s[3]=_(" khỏi hệ thống? "))])])]),_:2},1032,["onCancel","onSubmit"])]),_:1}))}}),A={class:"d-flex flex-column flex-grow-1 h-full"},E={class:"d-flex items-center"},G={class:"mt-2 h-[calc(100%_-_45px)] overflow-y-hidden"},ue=x({__name:"lo",setup(i){const n=[{title:"STT",align:"start",sortable:!1,key:"index",width:50},{title:"Tiêu chí đánh giá",key:"main_criteria",width:"45%",minWidth:350},{title:"Tiêu chí phụ",key:"sub_criteria",width:"35%",minWidth:250},{title:"Hệ số",key:"cof",width:"10%",minWidth:200},{title:"",key:"action",minWidth:100}],p=T({page:1,rowsPerPage:100,sortBy:"-created_at",sortType:"asc"}),e=B(()=>({...p.value}));g();const{items:o,totalItems:c,isLoading:r,refetch:u,isRefetching:v}=j(e);return(s,t)=>{const L=X;return V(),k("div",A,[t[5]||(t[5]=f("div",{class:"text-lg font-bold text-uppercase"},"Tạo LO mới",-1)),l(P,{class:"pa-3 h-full",color:"white",variant:"flat"},{default:a(()=>[f("div",E,[l(w,{"min-width":"500",width:"50%"},{activator:a(({props:m})=>[l(y,b({color:"success",size:"small"},m),{default:a(()=>[l(h,null,{default:a(()=>t[1]||(t[1]=[_("mdi-plus")])),_:1}),t[2]||(t[2]=f("span",null,"Thêm",-1))]),_:2},1040)]),default:a(({isActive:m})=>[l(L,{onCancel:O=>m.value=!1,onSuccess:d(u)},null,8,["onCancel","onSuccess"])]),_:1}),l(W),l(y,{icon:"",size:"x-small",variant:"text",onClick:t[0]||(t[0]=m=>d(u)())},{default:a(()=>[l(h,null,{default:a(()=>t[3]||(t[3]=[_("mdi-refresh")])),_:1})]),_:1})]),f("div",G,[l(Q,{class:"h-full","fixed-header":"",headers:n,"hide-default-footer":"",items:d(o),"items-per-page":100,loading:d(r)||d(v)},{"item.index":a(({index:m})=>[f("span",null,H(m+1),1)]),"item.action":a(({item:m})=>[l(w,{"min-width":"500",width:"50%"},{activator:a(({props:O})=>[l(y,b({color:"success",icon:"",size:"small",variant:"text"},O),{default:a(()=>[l(h,{color:"success"},{default:a(()=>t[4]||(t[4]=[_("mdi-pencil")])),_:1})]),_:2},1040)]),default:a(({isActive:O})=>[l(M,{lo:m,onCancel:J=>O.value=!1,onSuccess:d(u)},null,8,["lo","onCancel","onSuccess"])]),_:2},1024),l(I,{lo:m,onSuccess:d(u)},null,8,["lo","onSuccess"])]),_:1},8,["items","loading"])])]),_:1})])}}});export{ue as default};
